#!/bin/sh

connection=$(pgrep -a openvpn$ | head -n 1 | awk '{print $NF }' | cut -d '.' -f 1)
ip="$(curl -sf -4 ifconfig.io --connect-timeout 2)"
ip6="$(curl -sf -6 ifconfig.io --connect-timeout 2)"

# TODO: change this part to use windscribe api
usip=$(cat /home/jayadeep/workspace/vpn/wg0-client-arch.conf | grep Endpoint | cut -f2 -d= | cut -f1 -d: | xargs)
inip=$(cat /home/jayadeep/workspace/vpn/in-client-arch.conf | grep Endpoint | cut -f2 -d= | cut -f1 -d: | xargs)

type=""

case $ip in
  $personalVpn)
    type="vpn(personal): "
    ;;
  $usip)
    type="wg(us): "
    ;;
  $inip)
    type="wg(in): "
    ;;
  *)
    type=""
    ;;
esac

echo "%{F#0ff}ï‚¬ %{F-}$type %{F#0fc}$ip%{F-}%{F#0cf} $ip6${F-}"

